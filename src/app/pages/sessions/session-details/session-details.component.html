<div class="row">
    <div class="col-md-12">
        <nb-card size="small">
            <nb-card-header>
                <div class="header-content">
                    <div>Session {{session.name}}</div>
                    <div>
                        <nb-actions size="large">
                            <nb-action>
                                Actions
                            </nb-action> 
                            <nb-action class="icon" (click)="joinSession()" nbTooltip="Join Session" nbTooltipPlacement="top">
                                <i class="fa fa-sign-in-alt" style="color: #012051;"></i>
                            </nb-action> 
                            <nb-action class="icon" (click)="replaySession()" nbTooltip="Replay Session" nbTooltipPlacement="top">
                                <i class="fa fa-play-circle" style="color: #01500a;"></i>
                            </nb-action> 
                            <nb-action class="icon" (click)="deleteSession()" nbTooltip="Delete Session" nbTooltipPlacement="top">
                                <i class="fas fa-trash-alt" style="color: firebrick"></i>
                            </nb-action>
                        </nb-actions>

                    </div>
                </div>
                
            </nb-card-header>
            <nb-card-body>
                <nb-tabset fullWidth>
                    
                    <nb-tab tabTitle="Session Members">
                        <div class="member" *ngFor="let m of members; let i = index">
                            <nb-user *ngIf="!members_details[i].anonymous else anonUser" [picture]="members_details[i].photo_url" [name]="m.email" [title]="members_details[i].firstname + ' ' + members_details[i].lastname" size="large">
                            </nb-user>
                            <ng-template #anonUser>
                                <nb-user *ngIf="members_details[i].anonymous" nbTooltip="This user might not be registered" nbTooltipPlacement="top"
                                badgeStatus="warning" badgeText="?" 
                                [picture]="members_details[i].photo_url" [name]="m.email" [title]="members_details[i].firstname + ' ' + members_details[i].lastname" size="large">
                                </nb-user>
                            </ng-template> 
                            <div>
                                <nb-checkbox [(ngModel)]="m.canEdit" (ngModelChange)="showSaveButton($event)">Can Edit</nb-checkbox>    
                                <nb-checkbox [(ngModel)]="members_to_remove[i]" (ngModelChange)="showSaveButton($event)">Remove</nb-checkbox>                                
                            </div>
                        </div>
                    
                    </nb-tab>
                    
                    <nb-tab tabTitle="Session Details">
                        <div class="row">
                        
                            <div class="col-sm-6">
                                <ngx-add-user-widget (add)="addUser($event)"></ngx-add-user-widget>
                                <div class="row" style="margin-top: 10px;" *ngFor="let user of users; let i = index">
                                    <div class="input-group col-sm-6">
                                        <input type="email" [(ngModel)]="user.email" nbInput fullWidth placeholder="User Email">
                                    </div>
                                    <nb-checkbox [(ngModel)]="user.canEdit" class="col-sm-2">ViewOnly</nb-checkbox>
                                    <nb-actions class="col-sm-4" size="medium">   
                                        <nb-action icon="nb-close" (click)="removeUser(i)" nbTooltip="Remove User" nbTooltipPlacement="top"></nb-action> 
                                    </nb-actions>
                                </div>
                            </div>
    
                            <div class="col-sm-6" style="text-align: center;" >
                                <div>
                                    <h4> Configure HotJoin Access
                                        <i class="icon nb-help" [nbPopover]="icon" nbTooltip="Allow access to the session through a general link" nbTooltipPlacement="top"></i>
                                    </h4>
                                    <nb-checkbox [(ngModel)]="session.allowHotJoin" class="col-sm-2">Allow HotJoin</nb-checkbox>
                                    <br>
                                    <input *ngIf="session.allowHotJoin" type="number" [(ngModel)]="session.memberLimit" nbInput fullWidth placeholder="Maximum Users" style="width: 50%;">
                                </div>

                                <br>
                                
                                <div>
                                    <h4>Configure Access dates</h4>
                            
                                    <input nbInput [owlDateTime]="dt1" [owlDateTimeTrigger]="dt1" placeholder="Start Date" [(ngModel)]="session.startDate">
                                    <owl-date-time [startAt]="session?.startDate" #dt1></owl-date-time>
        
                                    <input style="margin-left: 0.5em;" nbInput [owlDateTime]="dt2" [owlDateTimeTrigger]="dt2" placeholder="End Date" [(ngModel)]="session.endDate">
                                    <owl-date-time [startAt]="session?.endDate" #dt2></owl-date-time>
                                </div>
                                
                            </div>

                        </div>
                    </nb-tab>
                    
                </nb-tabset>
                <button *ngIf="showSaveBtn" nbButton (click)="editSession()">Save Changes</button>
            </nb-card-body>
        </nb-card>
    </div>
</div>
  